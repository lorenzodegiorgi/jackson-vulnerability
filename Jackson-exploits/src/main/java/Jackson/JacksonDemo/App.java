package Jackson.JacksonDemo;

import java.io.File;
import java.io.IOException;
import com.fasterxml.jackson.core.JsonGenerationException;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.MapperFeature;
import com.fasterxml.jackson.databind.ObjectMapper;

public class App
{
	public static void main( String[] args ) throws Exception
    {
        ObjectMapper objectMapper = new ObjectMapper();
        objectMapper.enableDefaultTyping();

        ElectricEngine engine = new ElectricEngine();
		engine.engineModel = 1;
		engine.cc = 100;
		engine.maxEnergy = 100;

		FuelEngine fuelEngine = new FuelEngine();
		fuelEngine.fuel = 200;

		Car car = new Car();
		car.engine = engine;
		car.secEngine = fuelEngine;

		String exploit_JSON = "car_spring.json";

        //From JSON to class
        Car newCar = objectMapper.readValue(new File(exploit_JSON), Car.class);

        //Since the exploit in car_jdbc.json works with setters, uncomment this line
        //objectMapper.writeValue(new File("target/car_w.json"), newCar);

        System.out.print("Engine type: " + newCar.engine.getClass().getName());
        System.out.print("\n");
    	System.out.print("secEngine type: " + newCar.secEngine.getClass().getName());
    }
}
